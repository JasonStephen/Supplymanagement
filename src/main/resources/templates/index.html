<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">
<h1>欢迎访问系统</h1>
<div th:if="${user != null}" class="mt-4">
    <p>欢迎, <span th:text="${user.username}">用户名</span>!</p>
    <form th:action="@{/user/logout}" method="post" id="logoutForm">
        <button type="submit" class="btn btn-danger">登出</button>
    </form>
</div>
<div th:if="${user == null}" class="mt-4">
    <a th:href="@{/login}" class="btn btn-primary me-2">前往登录</a>
    <a th:href="@{/register}" class="btn btn-success">前往注册</a>
</div>
<div class="mt-4">
    <a th:href="@{/role}" class="btn btn-info">角色管理</a>
</div>
<div class="mt-4">
    <a th:href="@{/product}" class="btn btn-info">产品管理</a>
    <a th:href="@{/material}" class="btn btn-info">材料管理</a>
</div>

<script>
    document.getElementById('logoutForm').addEventListener('submit', function(event) {
        event.preventDefault(); // 阻止默认表单提交
        fetch(this.action, {
            method: this.method,
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            }
        }).then(response => {
            if (response.status === 204) {
                window.location.reload(); // 成功登出后刷新页面
            }
        });
    });
</script>
</body>
</html>