<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户信息</title>
    <link rel="stylesheet" th:href="@{/css/userinfo.css}">
    <link rel="stylesheet" th:href="@{/css/sidebar.css}">
    <link rel="stylesheet" th:href="@{/css/navigation-bar.css}">
    <script th:src="@{/js/navigation-bar.js}"></script>
    <script th:src="@{/js/userinfo.js}"></script>

</head>
<body>
<div th:replace="~{fragments/navigation-bar :: navigation-bar}"></div>
<div class="container">
    <div class="menu-icon" onclick="toggleSidebar()">☰</div>
    <!-- 侧边栏 -->
    <div th:replace="~{fragments/sidebar :: sidebar}"></div>

    <!-- 右侧用户信息展示区 -->
    <div class="content">
        <div class="user-info">
            <!-- 用户头像 -->
            <div class="avatar">
                <img th:src="${user.avatar != null} ? ${user.avatar} : '/api/v1/user/uploads/avatar/default.png'" alt="用户头像" width="192" height="192">
            </div>

            <!-- 用户信息 -->
            <div class="details">
                <h1>用户名称</h1>
                <p class="username" th:text="${user.username}"></p>
                <p>用户角色：<span th:text="${user.role.roleName}"></span></p>
                <p>用户邮箱：<span th:text="${user.email}"></span></p>
                <button onclick="openEditModal()">修改用户信息</button>
            </div>
        </div>
    </div>
</div>

<!-- 修改用户信息的弹窗 -->
<div id="editModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeEditModal()">&times;</span>
        <h2>修改用户信息</h2>
        <form id="editForm">
            <label for="username">用户名称:</label>
            <input type="text" id="username" name="username" th:value="${user.username}" required>

            <label for="phone">手机号:</label>
            <input type="text" id="phone" name="phone" th:value="${user.phone}" required>

            <label for="email">邮箱:</label>
            <input type="email" id="email" name="email" th:value="${user.email}" required>

            <button type="button" onclick="openAvatarUpload()">修改头像</button>
            <button type="button" onclick="openPasswordChange()">修改密码</button>

            <!-- 修改密码部分 -->
            <div id="passwordChange" style="display: none;">
                <label for="password">新密码:</label>
                <input type="password" id="password" name="password" required>

                <label for="confirmPassword">确认密码:</label>
                <input type="password" id="confirmPassword" name="confirmPassword" required>

                <button type="button" onclick="changePassword()">更改密码</button>
            </div>

            <!-- 修改头像部分 -->
            <div id="avatarUpload" style="display: none;">
                <input type="file" id="avatar" name="avatar" accept="image/*" style="display: none;">
                <button type="button" onclick="document.getElementById('avatar').click()">选择头像</button>
                <button type="button" onclick="uploadAvatar()">上传头像</button>
            </div>

            <button type="button" onclick="submitEditForm()">确认修改</button>
        </form>
    </div>
</div>
<script th:src="@{/js/sidebar.js}"></script>
</body>
</html>
